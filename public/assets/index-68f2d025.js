import{r as m,R as D,j as a,a as Le,c as Re,b as Fe}from"./index-46eb3233.js";var Ge=Symbol.for("immer-nothing"),we=Symbol.for("immer-draftable"),M=Symbol.for("immer-state");function G(e,...t){throw new Error(`[Immer] minified error nr: ${e}. Full error at: https://bit.ly/3cXEKWf`)}var U=Object.getPrototypeOf;function q(e){return!!e&&!!e[M]}function P(e){var t;return e?Ee(e)||Array.isArray(e)||!!e[we]||!!((t=e.constructor)!=null&&t[we])||ne(e)||oe(e):!1}var $e=Object.prototype.constructor.toString();function Ee(e){if(!e||typeof e!="object")return!1;const t=U(e);if(t===null)return!0;const n=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;return n===Object?!0:typeof n=="function"&&Function.toString.call(n)===$e}function K(e,t){te(e)===0?Object.entries(e).forEach(([n,o])=>{t(n,o,e)}):e.forEach((n,o)=>t(o,n,e))}function te(e){const t=e[M];return t?t.type_:Array.isArray(e)?1:ne(e)?2:oe(e)?3:0}function de(e,t){return te(e)===2?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function ze(e,t,n){const o=te(e);o===2?e.set(t,n):o===3?e.add(n):e[t]=n}function Ue(e,t){return e===t?e!==0||1/e===1/t:e!==e&&t!==t}function ne(e){return e instanceof Map}function oe(e){return e instanceof Set}function A(e){return e.copy_||e.base_}function me(e,t){if(ne(e))return new Map(e);if(oe(e))return new Set(e);if(Array.isArray(e))return Array.prototype.slice.call(e);if(!t&&Ee(e))return U(e)?{...e}:Object.assign(Object.create(null),e);const n=Object.getOwnPropertyDescriptors(e);delete n[M];let o=Reflect.ownKeys(n);for(let r=0;r<o.length;r++){const i=o[r],s=n[i];s.writable===!1&&(s.writable=!0,s.configurable=!0),(s.get||s.set)&&(n[i]={configurable:!0,writable:!0,enumerable:s.enumerable,value:e[i]})}return Object.create(U(e),n)}function X(e,t=!1){return re(e)||q(e)||!P(e)||(te(e)>1&&(e.set=e.add=e.clear=e.delete=qe),Object.freeze(e),t&&K(e,(n,o)=>X(o,!0))),e}function qe(){G(2)}function re(e){return Object.isFrozen(e)}var We={};function L(e){const t=We[e];return t||G(0,e),t}var Y;function Te(){return Y}function Je(e,t){return{drafts_:[],parent_:e,immer_:t,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function ve(e,t){t&&(L("Patches"),e.patches_=[],e.inversePatches_=[],e.patchListener_=t)}function ke(e){fe(e),e.drafts_.forEach(He),e.drafts_=null}function fe(e){e===Y&&(Y=e.parent_)}function Ce(e){return Y=Je(Y,e)}function He(e){const t=e[M];t.type_===0||t.type_===1?t.revoke_():t.revoked_=!0}function je(e,t){t.unfinalizedDrafts_=t.drafts_.length;const n=t.drafts_[0];return e!==void 0&&e!==n?(n[M].modified_&&(ke(t),G(4)),P(e)&&(e=V(t,e),t.parent_||ee(t,e)),t.patches_&&L("Patches").generateReplacementPatches_(n[M].base_,e,t.patches_,t.inversePatches_)):e=V(t,n,[]),ke(t),t.patches_&&t.patchListener_(t.patches_,t.inversePatches_),e!==Ge?e:void 0}function V(e,t,n){if(re(t))return t;const o=t[M];if(!o)return K(t,(r,i)=>pe(e,o,t,r,i,n)),t;if(o.scope_!==e)return t;if(!o.modified_)return ee(e,o.base_,!0),o.base_;if(!o.finalized_){o.finalized_=!0,o.scope_.unfinalizedDrafts_--;const r=o.copy_;let i=r,s=!1;o.type_===3&&(i=new Set(r),r.clear(),s=!0),K(i,(f,u)=>pe(e,o,r,f,u,n,s)),ee(e,r,!1),n&&e.patches_&&L("Patches").generatePatches_(o,n,e.patches_,e.inversePatches_)}return o.copy_}function pe(e,t,n,o,r,i,s){if(q(r)){const f=i&&t&&t.type_!==3&&!de(t.assigned_,o)?i.concat(o):void 0,u=V(e,r,f);if(ze(n,o,u),q(u))e.canAutoFreeze_=!1;else return}else s&&n.add(r);if(P(r)&&!re(r)){if(!e.immer_.autoFreeze_&&e.unfinalizedDrafts_<1)return;V(e,r),(!t||!t.scope_.parent_)&&ee(e,r)}}function ee(e,t,n=!1){!e.parent_&&e.immer_.autoFreeze_&&e.canAutoFreeze_&&X(t,n)}function Ke(e,t){const n=Array.isArray(e),o={type_:n?1:0,scope_:t?t.scope_:Te(),modified_:!1,finalized_:!1,assigned_:{},parent_:t,base_:e,draft_:null,copy_:null,revoke_:null,isManual_:!1};let r=o,i=xe;n&&(r=[o],i=Q);const{revoke:s,proxy:f}=Proxy.revocable(r,i);return o.draft_=f,o.revoke_=s,f}var xe={get(e,t){if(t===M)return e;const n=A(e);if(!de(n,t))return Xe(e,n,t);const o=n[t];return e.finalized_||!P(o)?o:o===se(e.base_,t)?(ce(e),e.copy_[t]=_e(o,e)):o},has(e,t){return t in A(e)},ownKeys(e){return Reflect.ownKeys(A(e))},set(e,t,n){const o=De(A(e),t);if(o!=null&&o.set)return o.set.call(e.draft_,n),!0;if(!e.modified_){const r=se(A(e),t),i=r==null?void 0:r[M];if(i&&i.base_===n)return e.copy_[t]=n,e.assigned_[t]=!1,!0;if(Ue(n,r)&&(n!==void 0||de(e.base_,t)))return!0;ce(e),he(e)}return e.copy_[t]===n&&(n!==void 0||t in e.copy_)||Number.isNaN(n)&&Number.isNaN(e.copy_[t])||(e.copy_[t]=n,e.assigned_[t]=!0),!0},deleteProperty(e,t){return se(e.base_,t)!==void 0||t in e.base_?(e.assigned_[t]=!1,ce(e),he(e)):delete e.assigned_[t],e.copy_&&delete e.copy_[t],!0},getOwnPropertyDescriptor(e,t){const n=A(e),o=Reflect.getOwnPropertyDescriptor(n,t);return o&&{writable:!0,configurable:e.type_!==1||t!=="length",enumerable:o.enumerable,value:n[t]}},defineProperty(){G(11)},getPrototypeOf(e){return U(e.base_)},setPrototypeOf(){G(12)}},Q={};K(xe,(e,t)=>{Q[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}});Q.deleteProperty=function(e,t){return Q.set.call(this,e,t,void 0)};Q.set=function(e,t,n){return xe.set.call(this,e[0],t,n,e[0])};function se(e,t){const n=e[M];return(n?A(n):e)[t]}function Xe(e,t,n){var r;const o=De(t,n);return o?"value"in o?o.value:(r=o.get)==null?void 0:r.call(e.draft_):void 0}function De(e,t){if(!(t in e))return;let n=U(e);for(;n;){const o=Object.getOwnPropertyDescriptor(n,t);if(o)return o;n=U(n)}}function he(e){e.modified_||(e.modified_=!0,e.parent_&&he(e.parent_))}function ce(e){e.copy_||(e.copy_=me(e.base_,e.scope_.immer_.useStrictShallowCopy_))}var Ye=class{constructor(e){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.produce=(t,n,o)=>{if(typeof t=="function"&&typeof n!="function"){const i=n;n=t;const s=this;return function(u=i,...p){return s.produce(u,g=>n.call(this,g,...p))}}typeof n!="function"&&G(6),o!==void 0&&typeof o!="function"&&G(7);let r;if(P(t)){const i=Ce(this),s=_e(t,void 0);let f=!0;try{r=n(s),f=!1}finally{f?ke(i):fe(i)}return ve(i,o),je(r,i)}else if(!t||typeof t!="object"){if(r=n(t),r===void 0&&(r=t),r===Ge&&(r=void 0),this.autoFreeze_&&X(r,!0),o){const i=[],s=[];L("Patches").generateReplacementPatches_(t,r,i,s),o(i,s)}return r}else G(1,t)},this.produceWithPatches=(t,n)=>{if(typeof t=="function")return(s,...f)=>this.produceWithPatches(s,u=>t(u,...f));let o,r;return[this.produce(t,n,(s,f)=>{o=s,r=f}),o,r]},typeof(e==null?void 0:e.autoFreeze)=="boolean"&&this.setAutoFreeze(e.autoFreeze),typeof(e==null?void 0:e.useStrictShallowCopy)=="boolean"&&this.setUseStrictShallowCopy(e.useStrictShallowCopy)}createDraft(e){P(e)||G(8),q(e)&&(e=Qe(e));const t=Ce(this),n=_e(e,void 0);return n[M].isManual_=!0,fe(t),n}finishDraft(e,t){const n=e&&e[M];(!n||!n.isManual_)&&G(9);const{scope_:o}=n;return ve(o,t),je(void 0,o)}setAutoFreeze(e){this.autoFreeze_=e}setUseStrictShallowCopy(e){this.useStrictShallowCopy_=e}applyPatches(e,t){let n;for(n=t.length-1;n>=0;n--){const r=t[n];if(r.path.length===0&&r.op==="replace"){e=r.value;break}}n>-1&&(t=t.slice(n+1));const o=L("Patches").applyPatches_;return q(e)?o(e,t):this.produce(e,r=>o(r,t))}};function _e(e,t){const n=ne(e)?L("MapSet").proxyMap_(e,t):oe(e)?L("MapSet").proxySet_(e,t):Ke(e,t);return(t?t.scope_:Te()).drafts_.push(n),n}function Qe(e){return q(e)||G(10,e),Oe(e)}function Oe(e){if(!P(e)||re(e))return e;const t=e[M];let n;if(t){if(!t.modified_)return t.base_;t.finalized_=!0,n=me(e,t.scope_.immer_.useStrictShallowCopy_)}else n=me(e,!0);return K(n,(o,r)=>{ze(n,o,Oe(r))}),t&&(t.finalized_=!1),n}var I=new Ye,Ze=I.produce;I.produceWithPatches.bind(I);I.setAutoFreeze.bind(I);I.setUseStrictShallowCopy.bind(I);I.applyPatches.bind(I);I.createDraft.bind(I);I.finishDraft.bind(I);function E(e){var t=m.useState(function(){return X(typeof e=="function"?e():e,!0)}),n=t[1];return[t[0],m.useCallback(function(o){n(typeof o=="function"?Ze(o):X(o))},[])]}var Se={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},Be=D.createContext&&D.createContext(Se),O=globalThis&&globalThis.__assign||function(){return O=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++){t=arguments[n];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e},O.apply(this,arguments)},Ve=globalThis&&globalThis.__rest||function(e,t){var n={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(n[o]=e[o]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,o=Object.getOwnPropertySymbols(e);r<o.length;r++)t.indexOf(o[r])<0&&Object.prototype.propertyIsEnumerable.call(e,o[r])&&(n[o[r]]=e[o[r]]);return n};function Ae(e){return e&&e.map(function(t,n){return D.createElement(t.tag,O({key:n},t.attr),Ae(t.child))})}function F(e){return function(t){return D.createElement(et,O({attr:O({},e.attr)},t),Ae(e.child))}}function et(e){var t=function(n){var o=e.attr,r=e.size,i=e.title,s=Ve(e,["attr","size","title"]),f=r||n.size||"1em",u;return n.className&&(u=n.className),e.className&&(u=(u?u+" ":"")+e.className),D.createElement("svg",O({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},n.attr,o,s,{className:u,style:O(O({color:e.color||n.color},n.style),e.style),height:f,width:f,xmlns:"http://www.w3.org/2000/svg"}),i&&D.createElement("title",null,i),e.children)};return Be!==void 0?D.createElement(Be.Consumer,null,function(n){return t(n)}):t(Se)}function tt(e){return F({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M19 21l-7-5-7 5V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2z"}}]})(e)}function nt(e){return F({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"9 18 15 12 9 6"}}]})(e)}function ot(e){return F({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"}}]})(e)}function rt(e){return F({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"}}]})(e)}function at(e){return F({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"12",y1:"5",x2:"12",y2:"19"}},{tag:"line",attr:{x1:"5",y1:"12",x2:"19",y2:"12"}}]})(e)}function it(e){return F({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"circle",attr:{cx:"12",cy:"12",r:"5"}},{tag:"line",attr:{x1:"12",y1:"1",x2:"12",y2:"3"}},{tag:"line",attr:{x1:"12",y1:"21",x2:"12",y2:"23"}},{tag:"line",attr:{x1:"4.22",y1:"4.22",x2:"5.64",y2:"5.64"}},{tag:"line",attr:{x1:"18.36",y1:"18.36",x2:"19.78",y2:"19.78"}},{tag:"line",attr:{x1:"1",y1:"12",x2:"3",y2:"12"}},{tag:"line",attr:{x1:"21",y1:"12",x2:"23",y2:"12"}},{tag:"line",attr:{x1:"4.22",y1:"19.78",x2:"5.64",y2:"18.36"}},{tag:"line",attr:{x1:"18.36",y1:"5.64",x2:"19.78",y2:"4.22"}}]})(e)}function st(e){return F({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"18",y1:"6",x2:"6",y2:"18"}},{tag:"line",attr:{x1:"6",y1:"6",x2:"18",y2:"18"}}]})(e)}const ct="_container_d2qfy_1",J={container:ct,"header-bar":"_header-bar_d2qfy_6","center-box":"_center-box_d2qfy_19"},lt="_button_fu0k7_1",Pe={button:lt,"button-group":"_button-group_fu0k7_75"},R=e=>{const{size:t="default",type:n="default",onClick:o}=e;return a.jsx("div",{className:[Pe.button,"theme-transition"].join(" "),"data-button":"true","data-size":t,"data-type":n,"data-icon":e.icon,onClick:o,children:e.children})},ye=e=>a.jsx("div",{className:Pe["button-group"],children:e.children}),ut="_clock_pvs0o_1",dt="_time_pvs0o_12",mt="_date_pvs0o_13",le={clock:ut,time:dt,date:mt},kt=["周日","周一","周二","周三","周四","周五","周六"],ft=()=>{const e=m.useRef(),[t,n]=E({hours:"16",minutes:"01",month:"4",date:"29",week:6,showColon:!0});return m.useEffect(()=>{const o=()=>{const r=new Date,i=r.getHours(),s=r.getMinutes(),f=r.getMonth()+1,u=r.getDate(),p=r.getDay();n(g=>{g.hours=i<10?`0${i}`:`${i}`,g.minutes=s<10?`0${s}`:`${s}`,g.month=`${f}`,g.date=`${u}`,g.week=p,g.showColon=!g.showColon})};return o(),e.current=setInterval(o,1e3),()=>{clearInterval(e.current)}},[n]),a.jsxs("div",{className:[le.clock,"theme-transition"].join(" "),children:[a.jsxs("div",{className:le.time,children:[a.jsx("div",{"data-type":"hours",children:t.hours}),a.jsx("div",{"data-type":"colon",children:t.showColon?":":""}),a.jsx("div",{"data-type":"minutes",children:t.minutes})]}),a.jsxs("div",{className:le.date,children:[a.jsx("div",{"data-type":"month",children:`${t.month}月${t.date}日`}),a.jsx("div",{"data-type":"week",children:kt[t.week]})]})]})},ht={"search-bar":"_search-bar_1fnug_1"},_t=()=>{const e=m.useRef(null);return m.useEffect(()=>{e.current instanceof HTMLInputElement&&e.current.focus()},[]),a.jsx("div",{className:ht["search-bar"],children:a.jsx("input",{ref:e,type:"text",className:"theme-transition",onFocus:t=>t.target.select(),onKeyDown:t=>{if(t.key==="Enter"){const o=`https://www.google.com/search?q=${t.target.value.trim()}&ie=UTF-8`;window.open(o,"_self")}}})})},xt="_item_tdq6g_78",B={"bookmark-drawer":"_bookmark-drawer_tdq6g_1","drawer-content":"_drawer-content_tdq6g_46","drawer-content-box":"_drawer-content-box_tdq6g_53","drawer-content-box-header":"_drawer-content-box-header_tdq6g_57","drawer-content-box-title":"_drawer-content-box-title_tdq6g_67","drawer-content-box-addbutton":"_drawer-content-box-addbutton_tdq6g_72","drawer-content-box-list":"_drawer-content-box-list_tdq6g_75",item:xt,"item-icon":"_item-icon_tdq6g_101","item-title":"_item-title_tdq6g_111","item-arrow":"_item-arrow_tdq6g_114","content-divider":"_content-divider_tdq6g_123","drawer-footer":"_drawer-footer_tdq6g_129"},ge={"context-menu":"_context-menu_38x9x_1","menu-item":"_menu-item_38x9x_44","menu-item-divider":"_menu-item-divider_38x9x_65"},yt="_modal_hnt7d_1",T={"modal-mask":"_modal-mask_hnt7d_1",modal:yt,"modal-header":"_modal-header_hnt7d_51","modal-title":"_modal-title_hnt7d_61","modal-close":"_modal-close_hnt7d_66","modal-content":"_modal-content_hnt7d_83","modal-footer":"_modal-footer_hnt7d_90","confirm-message":"_confirm-message_hnt7d_99"},H={default:[420,600],large:[950,600],small:[400,320]},gt=m.memo(e=>{const[t,n]=E({render:!1,show:!1}),o=m.useRef(null),r=m.useRef({width:0,height:0,top:0,left:0}),i=m.useRef(!1),s=()=>{e.onOk&&e.onOk(),e.okButtonClose!==!1&&e.onClose&&e.onClose()},f=()=>{e.onCancel&&e.onCancel(),e.cancelButtonClose!==!1&&e.onClose&&e.onClose()};return m.useLayoutEffect(()=>{i.current||(e.open&&!t.render&&!t.show&&n(u=>{u.render=!0}),e.open&&t.render&&!t.show&&requestAnimationFrame(()=>{n(u=>{u.show=!0})}),!e.open&&t.render&&t.show&&(n(u=>{u.show=!1}),setTimeout(()=>{n(u=>{u.render=!1,e.onClosed&&e.onClosed()})},300)))},[e.open,e.onClosed,t.render,t.show]),m.useEffect(()=>{let u;function p(){r.current.width=H.default[0],r.current.height=H.default[1],Array.isArray(e.size)&&e.size.length===2&&typeof e.size[0]=="number"&&typeof e.size[1]=="number"?(r.current.width=e.size[0],r.current.height=e.size[1]):e.size&&!Array.isArray(e.size)&&H[e.size]&&(r.current.width=H[e.size][0],r.current.height=H[e.size][1])}function g(){const{width:_,height:w}=r.current;r.current.top=window.innerHeight*.5-w*.5,r.current.left=window.innerWidth*.5-_*.5}function x(){if(o.current){const{width:_,height:w,top:z,left:k}=r.current;o.current.style.width=`${_}px`,o.current.style.height=`${w}px`,o.current.style.top=`${z}px`,o.current.style.left=`${k}px`}}function v(){clearTimeout(u),u=setTimeout(()=>{g(),x()},300)}return p(),g(),x(),window.addEventListener("resize",v),()=>{window.removeEventListener("resize",v)}},[e.size,t.render]),m.useEffect(()=>{e.onReady&&e.onReady({doClose(){i.current=!0,n(u=>{u.show=!1}),setTimeout(()=>{n(u=>{u.render=!1}),e.onClosed&&e.onClosed(),i.current=!1},300)}})},[]),t.render?Le.createPortal(a.jsxs(a.Fragment,{children:[e.mask!==!1?a.jsx("div",{"data-show":t.show,className:T["modal-mask"]}):null,a.jsxs("div",{ref:o,className:T.modal,"data-show":t.show,children:[a.jsxs("div",{className:T["modal-header"],children:[a.jsx("div",{className:[T["modal-title"],"theme-transition"].join(" "),children:e.title}),a.jsx("div",{className:[T["modal-close"],"theme-transition"].join(" "),onClick:e.onClose,children:a.jsx(st,{})})]}),a.jsx("div",{className:T["modal-content"],children:e.children}),e.customButtons&&e.customButtons.length>0||e.okButton!==!1||e.cancelButton!==!1?a.jsx("div",{className:T["modal-footer"],children:a.jsxs(ye,{children:[e.customButtons,e.okButton!==!1?a.jsx(R,{type:"primary",onClick:s,children:e.okButtonText||"确 定"}):null,e.cancelButton!==!1?a.jsx(R,{onClick:f,children:e.cancelButtonText||"取 消"}):null]})}):null]})]}),document.body):null}),Z=e=>{let t=()=>{};return{open:(r,i)=>{const s=document.body.appendChild(document.createElement("div")),f=Re(s);f.render(a.jsx(D.StrictMode,{children:a.jsx(e,{Modal:gt,modalProps:{...i,open:!0,onReady(u){t=u.doClose},onClose(){t()},onClosed(){f.unmount(),document.body.removeChild(s)}},contentProps:r||{}})}))},close:()=>{t()}}},bt=Z(({Modal:e,modalProps:t,contentProps:n})=>a.jsx(e,{...t,title:n.title,size:[350,170],onOk:n.onOk,onCancel:n.onCancel,children:a.jsx("div",{className:T["confirm-message"],children:n.message})})),wt=()=>{const[e,t]=E({open:!1,top:0,left:0}),n=m.useRef(null);return{ref:n,open:(i,s)=>{t(f=>{f.open=!0,f.top=i,f.left=s,requestAnimationFrame(()=>{if(n.current){const{innerWidth:u,innerHeight:p}=window,{width:g,height:x}=n.current.getBoundingClientRect();t(v=>{let _=v.top,w=v.left;_=_<0?0:_,_=_+x>p?p-x:_,w=w<0?0:w,w=w+g>u?u-g:w,v.top=_,v.left=w})}})})},onClose:()=>{t(i=>{i.open=!1})},state:e}},$=e=>a.jsx("div",{className:ge["menu-item"],"data-danger":e.danger,onClick:()=>{e.confirm?bt.open({title:e.confirmTitle,message:e.confirmMessage,onOk(){e.onClick&&e.onClick()}}):e.onClick&&e.onClick()},children:e.children}),Me=()=>a.jsx("div",{className:ge["menu-item-divider"]}),vt=m.memo(m.forwardRef((e,t)=>{const[n,o]=E({render:!1,show:!1}),r=m.useRef(!1);return m.useLayoutEffect(()=>{e.open&&!n.render&&!n.show&&(o(i=>{i.render=!0}),requestAnimationFrame(()=>{o(i=>{i.show=!0})})),!e.open&&n.render&&n.show&&(o(i=>{i.show=!1,i.render=!1}),e.onClosed&&e.onClosed())},[e.open,n.render,n.show]),m.useEffect(()=>{const i=()=>{e.onClose&&e.onClose()};return window.addEventListener("click",i),()=>{window.removeEventListener("click",i)}},[]),n.render?Fe.createPortal(a.jsx("div",{ref:t,className:ge["context-menu"],"data-show":n.show,style:{top:`${e.top}px`,left:`${e.left}px`},onClick:i=>{r.current||(r.current=!0,i.stopPropagation(),i.preventDefault(),setTimeout(()=>{r.current=!1,e.onClose&&e.onClose()},100))},onContextMenu:i=>{i.stopPropagation(),i.preventDefault()},children:e.children}),document.body):null})),Ie=e=>a.jsxs("div",{className:B["drawer-content-box"],children:[a.jsxs("div",{className:B["drawer-content-box-header"],children:[a.jsx("div",{className:[B["drawer-content-box-title"],"theme-transition"].join(" "),children:e.title}),a.jsx("div",{className:B["drawer-content-box-addbutton"],children:a.jsx(R,{onClick:e.onAdd,children:a.jsx(at,{})})})]}),a.jsx("div",{className:B["drawer-content-box-list"],children:e.children})]}),Ne=e=>a.jsxs("div",{className:[B.item].join(" "),"data-active":e.active,onClick:e.onClick,onContextMenu:e.onContextMenu,children:[a.jsx("div",{className:B["item-icon"],children:typeof e.icon=="string"?a.jsx("img",{src:e.icon}):e.icon}),a.jsx("div",{className:B["item-title"],children:e.title}),e.arrow?a.jsx("div",{className:B["item-arrow"],children:a.jsx(nt,{})}):null]}),Ct=m.memo(e=>{var g;const{onAddBookmarkGroup:t,onAddBookmarkItem:n}=e,[o,r]=E({bookmarkGroupActiveId:e.bookmarkGroupList[0]?e.bookmarkGroupList[0].id:"",contextMenuTargetType:""}),i=wt(),s=m.useRef({contextMenuTargetId:"",contextMenuTargetType:""}),f=x=>{e.bookmarkGroupList.forEach(v=>{v.id===o.bookmarkGroupActiveId&&v.bookmarks.forEach(_=>{_.id===s.current.contextMenuTargetId&&window.open(_.url,x)})})},u=x=>{switch(x){case"open":f("_self");break;case"openNewPage":f("_blank");break;case"edit":s.current.contextMenuTargetType==="group"?e.onEditBookmarkGroup(s.current.contextMenuTargetId):e.onEditBookmarkItem(o.bookmarkGroupActiveId,s.current.contextMenuTargetId);break;case"moveUp":s.current.contextMenuTargetType==="group"?e.onMoveUpBookmarkGroup(s.current.contextMenuTargetId):e.onMoveUpBookmarkItem(o.bookmarkGroupActiveId,s.current.contextMenuTargetId);break;case"moveDown":s.current.contextMenuTargetType==="group"?e.onMoveDownBookmarkGroup(s.current.contextMenuTargetId):e.onMoveDownBookmarkItem(o.bookmarkGroupActiveId,s.current.contextMenuTargetId);break;case"delete":s.current.contextMenuTargetType==="group"?e.onDeleteBookmarkGroup(s.current.contextMenuTargetId):e.onDeleteBookmarkItem(o.bookmarkGroupActiveId,s.current.contextMenuTargetId);break}},p=((g=e.bookmarkGroupList.filter(({id:x})=>x===o.bookmarkGroupActiveId)[0])==null?void 0:g.bookmarks)||[];return m.useEffect(()=>{e.bookmarkGroupList.length>0&&!o.bookmarkGroupActiveId&&r(x=>{x.bookmarkGroupActiveId=e.bookmarkGroupList[0].id})},[e.bookmarkGroupList]),a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:[B["bookmark-drawer"],"theme-transition"].join(" "),"data-open":e.open,children:[a.jsxs("div",{className:B["drawer-content"],children:[a.jsx(Ie,{title:"书签分类",onAdd:t,children:e.bookmarkGroupList.map(({id:x,name:v})=>a.jsx(Ne,{icon:a.jsx(ot,{}),title:v,arrow:!0,active:x===o.bookmarkGroupActiveId,onClick:()=>{r(_=>{_.bookmarkGroupActiveId=x})},onContextMenu:_=>{_.preventDefault(),_.stopPropagation(),s.current.contextMenuTargetId=x,s.current.contextMenuTargetType="group",i.open(_.clientY,_.clientX),r(w=>{w.contextMenuTargetType="group"})}},x))}),a.jsx("div",{className:[B["content-divider"],"theme-transition"].join(" ")}),a.jsx(Ie,{title:"书签列表",onAdd:()=>n(o.bookmarkGroupActiveId),children:p.map(({id:x,name:v,icon:_,url:w})=>a.jsx(Ne,{icon:_,title:v,onClick:()=>{window.open(w,"_self")},onContextMenu:z=>{z.preventDefault(),z.stopPropagation(),s.current.contextMenuTargetId=x,s.current.contextMenuTargetType="item",i.open(z.clientY,z.clientX),r(k=>{k.contextMenuTargetType="item"})}},x))})]}),a.jsx("div",{className:[B["drawer-footer"],"theme-transition"].join(" "),children:a.jsxs(ye,{children:[a.jsx(R,{onClick:e.onExportBookmark,children:"备份"}),a.jsx(R,{onClick:e.onImportBookmark,children:"导入备份"})]})})]}),a.jsxs(vt,{ref:i.ref,...i.state,onClose:i.onClose,children:[o.contextMenuTargetType==="item"?a.jsxs(a.Fragment,{children:[a.jsx($,{onClick:()=>u("open"),children:"打开"}),a.jsx($,{onClick:()=>u("openNewPage"),children:"新页面打开"}),a.jsx(Me,{})]}):null,a.jsx($,{onClick:()=>u("edit"),children:"编辑"}),a.jsx($,{onClick:()=>u("moveUp"),children:"上移"}),a.jsx($,{onClick:()=>u("moveDown"),children:"下移"}),a.jsx(Me,{}),a.jsx($,{danger:!0,confirm:!0,confirmTitle:"确认删除",confirmMessage:"确实要删除此项？",onClick:()=>u("delete"),children:"删除"})]})]})});let be=(e=21)=>crypto.getRandomValues(new Uint8Array(e)).reduce((t,n)=>(n&=63,n<36?t+=n.toString(36):n<62?t+=(n-26).toString(36).toUpperCase():n>62?t+="-":t+="_",t),"");const ue={"form-item":"_form-item_nxy31_1","item-label":"_item-label_nxy31_16","item-content":"_item-content_nxy31_21"},W=e=>a.jsxs("div",{className:ue["form-item"],children:[e.label?a.jsx("div",{className:[ue["item-label"],"theme-transition"].join(" "),children:e.label}):null,a.jsx("div",{className:ue["item-content"],children:e.children})]}),jt=Z(({Modal:e,modalProps:t,contentProps:n})=>{const[o,r]=E({bookmarkGroupName:""});return a.jsx(e,{...t,title:"新增书签分类",size:"small",onOk:()=>{const i={id:be(),name:o.bookmarkGroupName,bookmarks:[]};n.onOk(i)},children:a.jsx(W,{label:"分类名",children:a.jsx("input",{value:o.bookmarkGroupName,onChange:i=>{r(s=>{s.bookmarkGroupName=i.target.value})}})})})}),pt=Z(({Modal:e,modalProps:t,contentProps:n})=>{const[o,r]=E({bookmarkName:"",bookmarkUrl:""});return a.jsxs(e,{...t,title:"新增书签",size:"small",onOk:()=>{const i={id:be(),name:o.bookmarkName,url:o.bookmarkUrl,icon:`${o.bookmarkUrl}/favicon.ico`};n.onOk(i)},children:[a.jsx(W,{label:"书签名称",children:a.jsx("input",{value:o.bookmarkName,onChange:i=>{r(s=>{s.bookmarkName=i.target.value})}})}),a.jsx(W,{label:"书签地址",children:a.jsx("input",{value:o.bookmarkUrl,onChange:i=>{r(s=>{s.bookmarkUrl=i.target.value})}})})]})}),Bt=Z(({Modal:e,modalProps:t,contentProps:n})=>{const[o,r]=E({bookmarkGroupName:n.bookmarkGroupName});return a.jsx(e,{...t,title:"修改书签分类名称",size:"small",onOk:()=>{n.onOk(o.bookmarkGroupName)},children:a.jsx(W,{label:"分类名",children:a.jsx("input",{value:o.bookmarkGroupName,onChange:i=>{r(s=>{s.bookmarkGroupName=i.target.value})}})})})}),Mt=Z(({Modal:e,modalProps:t,contentProps:n})=>{const[o,r]=E({bookmarkName:n.bookmarkItem.name,bookmarkUrl:n.bookmarkItem.url});return a.jsxs(e,{...t,title:"修改书签",size:"small",onOk:()=>{const i={...n.bookmarkItem,name:o.bookmarkName,url:o.bookmarkUrl,icon:`${o.bookmarkUrl}/favicon.ico`};n.onOk(i)},children:[a.jsx(W,{label:"书签名称",children:a.jsx("input",{value:o.bookmarkName,onChange:i=>{r(s=>{s.bookmarkName=i.target.value})}})}),a.jsx(W,{label:"书签地址",children:a.jsx("input",{value:o.bookmarkUrl,onChange:i=>{r(s=>{s.bookmarkUrl=i.target.value})}})})]})}),It=()=>{const[e,t]=E((()=>{let k=[];const d=JSON.parse(localStorage.getItem("bookmarks")||"[]");return Array.isArray(d)&&(k=d),k})()),n=m.useRef(e);n.current=e;const o=()=>{requestAnimationFrame(()=>{localStorage.setItem("bookmarks",JSON.stringify(n.current))})},r=m.useCallback(()=>{const k=document.createElement("input");k.type="file",k.addEventListener("change",()=>{const d=k.files;if(d){const l=new FileReader;l.addEventListener("load",()=>{if(l.result&&typeof l.result=="string"){const c=JSON.parse(l.result);t(c),o()}}),l.readAsText(d[0])}}),k.click()},[]),i=m.useCallback(()=>{const k=JSON.stringify(n.current),d=new Blob([k],{type:"application/json"}),l=URL.createObjectURL(d),c=document.createElement("a"),h=new Date,b=h.getFullYear();let y=h.getMonth()+1,C=h.getDate(),N=h.getHours(),j=h.getMinutes();y=y<10?`0${y}`:y,C=C<10?`0${C}`:C,N=N<10?`0${N}`:N,j=j<10?`0${j}`:j,c.href=l,c.download=`bookmarks_export_${be(4).toLocaleLowerCase()}_${b}${y}${C}${N}${j}`,c.style.visibility="hidden",document.body.appendChild(c),c.click(),document.body.removeChild(c),URL.revokeObjectURL(l)},[]),s=m.useCallback(()=>{jt.open({onOk(k){t(d=>{d.push(k),o()})}})},[]),f=m.useCallback(k=>{pt.open({onOk(d){t(l=>{l.forEach(({id:c},h)=>{c===k&&(l[h].bookmarks.push(d),o())})})}})},[]),u=m.useCallback(k=>{const d=n.current.find(({id:l})=>l===k);d&&Bt.open({bookmarkGroupName:d.name,onOk(l){t(c=>{c.forEach(({id:h},b)=>{h===d.id&&(c[b].name=l,o())})})}})},[]),p=m.useCallback((k,d)=>{const l=n.current.find(({id:c})=>c===k);if(l){const c=l.bookmarks.find(({id:h})=>h===d);c&&Mt.open({bookmarkItem:c,onOk(h){t(b=>{b.forEach((y,C)=>{y.id===k&&y.bookmarks.forEach((N,j)=>{N.id===d&&(b[C].bookmarks[j]=h,o())})})})}})}},[]),g=m.useCallback(k=>{t(n.current.filter(({id:d})=>d!==k)),o()},[]),x=m.useCallback((k,d)=>{t(l=>{l.forEach((c,h)=>{c.id===k&&(l[h].bookmarks=l[h].bookmarks.filter(({id:b})=>b!==d),o())})})},[]),v=m.useCallback(k=>{let d=0,l=0;const c=[...n.current];c.forEach(({id:y},C)=>{y===k&&(d=C,l=d-1<0?0:d-1)});const h=c[d],b=c[l];c[d]=b,c[l]=h,t(c),o()},[]),_=m.useCallback((k,d)=>{let l=0,c=0,h=0;const b=[...n.current];b.forEach((j,ae)=>{j.id===k&&(h=ae,j.bookmarks.forEach((ie,S)=>{ie.id===d&&(l=S,c=c=S-1<0?0:S-1)}))});const y=JSON.parse(JSON.stringify(n.current[h])),C=y.bookmarks[l],N=y.bookmarks[c];y.bookmarks[c]=C,y.bookmarks[l]=N,b[h]=y,t(b),o()},[]),w=m.useCallback(k=>{let d=0,l=0;const c=[...n.current];c.forEach(({id:y},C)=>{y===k&&(d=C,l=d+1>c.length-1?c.length-1:d+1)});const h=c[d],b=c[l];c[d]=b,c[l]=h,t(c),o()},[]),z=m.useCallback((k,d)=>{let l=0,c=0,h=0;const b=[...n.current];b.forEach((j,ae)=>{j.id===k&&(h=ae,j.bookmarks.forEach((ie,S)=>{ie.id===d&&(l=S,c=S+1>j.bookmarks.length-1?j.bookmarks.length-1:S+1)}))});const y=JSON.parse(JSON.stringify(n.current[h])),C=y.bookmarks[l],N=y.bookmarks[c];y.bookmarks[c]=C,y.bookmarks[l]=N,b[h]=y,t(b),o()},[]);return{bookmarkGroupList:e,handleImportBookmark:r,handleExportBookmark:i,handleAddBookmarkGroup:s,handleAddBookmarkItem:f,handleEditBookmarkGroup:u,handleEditBookmarkItem:p,handleDeleteBookmarkGroup:g,handleDeleteBookmarkItem:x,handleMoveUpBookmarkGroup:v,handleMoveUpBookmarkItem:_,handleMoveDownBookmarkGroup:w,handleMoveDownBookmarkItem:z}},Gt=()=>{const[e,t]=E({themeMode:document.documentElement.dataset.theme||"light",openBookmarkDrawer:!1}),{bookmarkGroupList:n,handleImportBookmark:o,handleExportBookmark:r,handleAddBookmarkGroup:i,handleAddBookmarkItem:s,handleEditBookmarkGroup:f,handleEditBookmarkItem:u,handleDeleteBookmarkGroup:p,handleDeleteBookmarkItem:g,handleMoveUpBookmarkGroup:x,handleMoveUpBookmarkItem:v,handleMoveDownBookmarkGroup:_,handleMoveDownBookmarkItem:w}=It(),z=()=>{t(l=>{const c=l.themeMode==="light"?"dark":"light";document.documentElement.dataset.theme=c,l.themeMode=c})},k=()=>{t(l=>{l.openBookmarkDrawer=!l.openBookmarkDrawer})},d=m.useCallback(()=>{t(l=>{l.openBookmarkDrawer=!1})},[t]);return m.useLayoutEffect(()=>{let l="light";window.matchMedia("(prefers-color-scheme: dark)").matches&&(l="dark"),t(c=>{c.themeMode=l}),document.documentElement.dataset.theme=l,window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",c=>{let h="light";c.matches&&(h="dark"),t(b=>{b.themeMode=h}),document.documentElement.dataset.theme=h})},[]),a.jsxs("div",{className:J.container,children:[a.jsxs("div",{className:J["header-bar"],children:[a.jsx("div",{className:J["header-bar-left"]}),a.jsx("div",{className:J["header-bar-right"],children:a.jsxs(ye,{children:[a.jsxs(R,{type:e.openBookmarkDrawer?"primary":"default",icon:!0,onClick:k,children:[a.jsx(tt,{})," 书签"]}),a.jsx(R,{onClick:z,children:e.themeMode==="dark"?a.jsx(rt,{}):a.jsx(it,{})})]})})]}),a.jsxs("div",{className:J["center-box"],children:[a.jsx(ft,{}),a.jsx(_t,{})]}),a.jsx(Ct,{open:e.openBookmarkDrawer,bookmarkGroupList:n,onClose:d,onImportBookmark:o,onExportBookmark:r,onAddBookmarkGroup:i,onAddBookmarkItem:s,onEditBookmarkGroup:f,onEditBookmarkItem:u,onDeleteBookmarkGroup:p,onDeleteBookmarkItem:g,onMoveUpBookmarkGroup:x,onMoveUpBookmarkItem:v,onMoveDownBookmarkGroup:_,onMoveDownBookmarkItem:w})]})};export{Gt as default};
